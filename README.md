# DVMH Performance Predictor

–°–∏—Å—Ç–µ–º–∞ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ DVMH (Distributed Virtual Memory Hierarchy).

## üìã –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

DVMH Performance Predictor - —ç—Ç–æ –∫–æ–º–ø–ª–µ–∫—Å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ DVMH –ø—Ä–æ–≥—Ä–∞–º–º –∏ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –∏—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è—Ö –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞. –°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–Ω–∏–º–∞–Ω–∏—è.

### üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** –∏–∑ Fortran –∏—Å—Ö–æ–¥–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- **–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –∏–∑ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–∫—Ä—ã—Ç–∏—è –∫–æ–¥–∞
- **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π** (MLP –∏ Attention-based –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã)
- **–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —É—Å–∫–æ—Ä–µ–Ω–∏—è** –¥–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
- **–î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π** –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–ê–Ω–∞–ª–∏–∑ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ PyTorch –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π
pip install torch torchvision

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install pandas numpy scikit-learn matplotlib seaborn pyyaml
```

## –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```bash
# 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
python main.py collect --source ./sources --results ./data/raw

# 2. –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω: –∞–≥—Ä–µ–≥–∞—Ü–∏—è + —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
python main.py pipeline --config config/data_config.yaml

# 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
python scripts/train.py --dataset data/processed/feature_dataset.csv

# 4. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
python scripts/predict.py program.f --grid "2,2" --threads 4 --time 1.5
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```bash
dvmh-performance-predictor/
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ data_config.yaml          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ data_collector.py         # –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –ø–æ–∫—Ä—ã—Ç–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ stats_aggregator.py       # –ê–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ feature_extractor.py      # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ feature_preprocessor.py   # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ model_trainer.py          # –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ model_finetuner.py        # –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
‚îÇ   ‚îú‚îÄ‚îÄ predictor.py              # –°–∏—Å—Ç–µ–º–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                  # –£—Ç–∏–ª–∏—Ç—ã
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ train.py                  # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ predict.py                # –°–∫—Ä–∏–ø—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ finetune.py               # –°–∫—Ä–∏–ø—Ç –¥–æ–æ–±—É—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ main.py                       # –ì–ª–∞–≤–Ω—ã–π –º–æ–¥—É–ª—å
‚îî‚îÄ‚îÄ README.md
```

–ü—Ä–∏–º–µ—Ä –ø–∞–ø–∫–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–º –∑–∞–ø—É—Å–∫–∞–º
```bash
parallel_results/
‚îú‚îÄ‚îÄ 1d/
‚îÇ   ‚îú‚îÄ‚îÄ program_name
‚îÇ       ‚îú‚îÄ‚îÄ p1_t1_1
‚îÇ           ‚îú‚îÄ‚îÄ stat.txt
‚îú‚îÄ‚îÄ 2d/
‚îÇ   ‚îú‚îÄ‚îÄ program_name
‚îÇ       ‚îú‚îÄ‚îÄ p1_t1_1x1
‚îÇ           ‚îú‚îÄ‚îÄ stat.txt
‚îú‚îÄ‚îÄ 3d/
‚îÇ   ‚îú‚îÄ‚îÄ program_name
‚îÇ       ‚îú‚îÄ‚îÄ p1_t1_1x1x1
‚îÇ           ‚îú‚îÄ‚îÄ stat.txt
‚îú‚îÄ‚îÄ 4d/
‚îÇ   ‚îú‚îÄ‚îÄ program_name
‚îÇ       ‚îú‚îÄ‚îÄ p1_t1_1x1x1x1
‚îÇ           ‚îú‚îÄ‚îÄ stat.txt
```

## üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
### 1. –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
–°–æ–±–∏—Ä–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ–∫—Ä—ã—Ç–∏—è –∏–∑ Fortran —Ñ–∞–π–ª–æ–≤:
```bash
python main.py collect --source ./sources --results ./data/raw
```
#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- --source - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å –∏—Å—Ö–æ–¥–Ω—ã–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏
- --results - –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

```bash
sources/
‚îú‚îÄ‚îÄ 1d/
‚îÇ   ‚îî‚îÄ‚îÄ program.f
‚îú‚îÄ‚îÄ 2d/
‚îÇ   ‚îú‚îÄ‚îÄ program.f
‚îú‚îÄ‚îÄ 3d/
‚îÇ   ‚îú‚îÄ‚îÄ program.f
‚îú‚îÄ‚îÄ 4d/
‚îÇ   ‚îú‚îÄ‚îÄ program.f
```

### 2. –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
```bash
# –¢–æ–ª—å–∫–æ –∞–≥—Ä–µ–≥–∞—Ü–∏—è
python main.py aggregate --config config/data_config.yaml

# –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
python main.py features --input aggregated_data.json --output dataset.csv

# –ü–æ–ª–Ω—ã–π –ø–∞–π–ø–ª–∞–π–Ω
python main.py pipeline --config config/data_config.yaml
```

### 3. –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
```bash
python scripts/train.py \
    --dataset data/processed/feature_dataset.csv \
    --epochs 150 \
    --batch-size 64 \
    --hidden-dims 512 256 128 \
    --test-programs 5
```
#### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

- --dataset - –ø—É—Ç—å –∫ –¥–∞—Ç–∞—Å–µ—Ç—É
- --epochs - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
- --batch-size - —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
- --hidden-dims - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤
- --test-programs - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–≥—Ä–∞–º–º –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 4. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
```bash
# –ò–∑ Fortran —Ñ–∞–π–ª–∞
python scripts/predict.py program.f \
    --grid "2,2" \
    --threads 4 \
    --time 1.5 \
    --model dvmh_attention_model

# –ò–∑ JSON —Ñ–∞–π–ª–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
python scripts/predict.py info.json \
    --grid "1,2,3" \
    --threads 8 \
    --time 2.1 \
    --output-format detailed
```

#### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

- --grid - —Å–µ—Ç–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ (—Ñ–æ—Ä–º–∞—Ç: "x,y,z" –∏–ª–∏ "xyz")
- --threads - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–∏—Ç–µ–π
- --time - –≤—Ä–µ–º—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- --model - –∏–º—è –º–æ–¥–µ–ª–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- --output-format - —Ñ–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ (simple/json/detailed)

### 5. –î–æ–æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π
```bash
python scripts/finetune.py \
    --base-model dvmh_mlp_model \
    --new-data new_programs.csv \
    --strategies "full_model,last_layers,gradual_unfreezing" \
    --lr 0.0001 \
    --epochs 50
```

#### –°—Ç—Ä–∞—Ç–µ–≥–∏–∏ –¥–æ–æ–±—É—á–µ–Ω–∏—è:

- full_model - –¥–æ–æ–±—É—á–µ–Ω–∏–µ –≤—Å–µ–π –º–æ–¥–µ–ª–∏
- last_layers - –¥–æ–æ–±—É—á–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–ª–æ–µ–≤
- adapter - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–¥–∞–ø—Ç–µ—Ä–Ω—ã—Ö —Å–ª–æ–µ–≤
- gradual_unfreezing - –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Ä–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤

## üß† –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–µ–π
### MLP –º–æ–¥–µ–ª—å (DVMHEfficiencyMLP)
```python
# –ú–Ω–æ–≥–æ—Å–ª–æ–π–Ω—ã–π –ø–µ—Ä—Ü–µ–ø—Ç—Ä–æ–Ω —Å BatchNorm –∏ Dropout
Hidden layers: [256, 128, 64]
Activation: ReLU
Regularization: Dropout (0.3), BatchNorm
Output: Single value (speedup prediction)
```
### Attention –º–æ–¥–µ–ª—å (DVMHAttentionModel)
```python
# –ú–æ–¥–µ–ª—å —Å –º–µ—Ö–∞–Ω–∏–∑–º–æ–º –≤–Ω–∏–º–∞–Ω–∏—è
Embedding: Linear(input_dim, hidden_dims[0])
Attention: Query-Key-Value mechanism
Hidden layers: [128, 64]
Output: Speedup + attention weights
```
